<h1 style="display: flex; align-items: center; justify-content: space-between">
  <button (click)="reset()">üîÑRESET</button>
  üìä Live Trade Scanner Dashboard
  <a
    href="https://kite.zerodha.com/connect/login?v=3&api_key=9c2asbtjjrdrwn2z"
    target="_blank"
    >‚èªlogin</a
  >
</h1>
<p>Total Signals: {{ tradeSignals.length }}</p>

<!-- ADD STOCK SYMBOLS INPUT -->
<div>
  <input type="text" [(ngModel)]="stockSymbols" placeholder="stock symbol" />
  <button (click)="addStockSymbols()">Add</button>
</div>

<!-- STOCK SYMBOLS LIST -->
<h2>üìà Stock Symbols List</h2>
<ul class="stock-symbols-list">
  <li *ngFor="let symbol of stockSymbolsInDb">
    {{ symbol }}
    <button (click)="removeStockSymbol(symbol)">Remove</button>
  </li>
  <li *ngIf="stockSymbolsInDb?.length === 0">No symbols added yet.</li>
</ul>

<h2>üî• Trade Signals</h2>
<table *ngIf="tradeSignals.length > 0" id="signal-table">
  <tr>
    <th>Stock</th>
    <th>Time</th>
    <th>Age</th>
    <th>Pattern</th>
    <th>Direction</th>
    <th>Entry</th>
    <th>SL</th>
    <th>Target1</th>
    <th>Target2</th>
    <th>Qty</th>
    <th>ATR</th>
    <th>Confidence</th>
    <th>Plan</th>
    <th>AI Explanation</th>
    <th>AI Review</th>
    <th>AI Advice</th>
  </tr>
  <tr *ngFor="let s of tradeSignals">
    <td>{{ s.stockName }}</td>
    <td>{{ s.dateTime }}</td>
    <td>{{ getSignalAge(s.dateTime) }}</td>
    <td>{{ s.pattern }}</td>
    <td [style.color]="s.direction === 'Long' ? 'green' : 'red'">
      {{ s.direction }}
    </td>
    <td>{{ s.entry }}</td>
    <td>{{ s.stopLoss }}</td>
    <td>{{ s.target1 }}</td>
    <td>{{ s.target2 }}</td>
    <td>{{ s.qty }}</td>
    <td>{{ s.atr }}</td>
    <td>{{ s.confidence }}</td>
    <td>{{ s.ai?.plan }}</td>
    <td>{{ s.ai?.explanation }}</td>
    <td>
      <em>{{ s.ai?.confidenceReview }}</em>
    </td>
    <td>{{ s.ai?.advisory }}</td>
    <!-- 
    <td><div [innerHTML]="s.ai?.plan | markdown"></div></td>
    <td><div [innerHTML]="s.ai?.explanation | markdown"></div></td>
    <td><div [innerHTML]="s.ai?.confidenceReview | markdown"></div></td>
    <td><div [innerHTML]="s.ai?.advisory | markdown"></div></td> -->
  </tr>
</table>

<h2>üìô Signal History</h2>
<!-- <table *ngIf="signalHistoryEntries.length > 0">
  <tr>
    <th>Stock</th>
    <th>Pattern</th>
    <th>Direction</th>
    <th>Time</th>
  </tr>
  <tr *ngFor="let entry of signalHistoryEntries">
    <td>{{ entry.stock }}</td>
    <td>{{ entry.pattern }}</td>
    <td [style.color]="entry.direction === 'Long' ? 'green' : 'red'">
      {{ entry.direction }}
    </td>
    <td>{{ entry.timestamp | date : "short" }}</td>
  </tr>
</table> -->
<table *ngIf="signals?.length > 0" id="signal-table">
  <tr>
    <th>Stock</th>
    <th>Time</th>
    <th>Age</th>
    <th>Pattern</th>
    <th>Direction</th>
    <th>Entry</th>
    <th>SL</th>
    <th>Target1</th>
    <th>Target2</th>
    <th>Qty</th>
    <th>ATR</th>
    <th>Confidence</th>
    <th>Plan</th>
    <th>AI Explanation</th>
    <th>AI Review</th>
    <th>AI Advice</th>
  </tr>
  <tr *ngFor="let s of signals">
    <td>{{ s.stockName }}</td>
    <td>{{ s.dateTime }}</td>
    <td>{{ getSignalAge(s.dateTime) }}</td>
    <td>{{ s.pattern }}</td>
    <td [style.color]="s.direction === 'Long' ? 'green' : 'red'">
      {{ s.direction }}
    </td>
    <td>{{ s.entry }}</td>
    <td>{{ s.stopLoss }}</td>
    <td>{{ s.target1 }}</td>
    <td>{{ s.target2 }}</td>
    <td>{{ s.qty }}</td>
    <td>{{ s.atr }}</td>
    <td>{{ s.confidence }}</td>
    <td>{{ s.ai?.plan }}</td>
    <td>{{ s.ai?.explanation }}</td>
    <td>
      <em>{{ s.ai?.confidenceReview }}</em>
    </td>
    <td>{{ s.ai?.advisory }}</td>
  </tr>
</table>
